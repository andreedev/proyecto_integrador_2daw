<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestión de Candidaturas</title>
    <link rel="icon" href="../img/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="../css/general-styles.css">
    <link rel="stylesheet" href="../css/menu-admin.css">
    <link rel="stylesheet" href="../css/admin-candidaturas.css">
    <link rel="stylesheet" href="../css/utils.css">
</head>

<body>
    <div id="splash">
        <img src="../img/logo-loading.gif" alt="Cargando...">
    </div>

    <div class="admin-super-container">
        <menu-admin></menu-admin>
        <div class="admin-page-content">
            <div class="admin-header">
                <div class="admin-header-module-info-container">
                    <p class="admin-module-name">Gestión de Candidaturas</p>
                    <span class="admin-module-description">Administra las candidaturas de los participantes</span>
                </div>
            </div>
            <div class="admin-content">
                <!-- FILTERS -->
                <div class="filters">
                    <div class="filter-search">
                        <input type="text" placeholder="Buscar por participante o sinopsis…">
                    </div>
                    <div class="filter-status">
                        <select>
                            <option disabled selected>Todos los estados</option>
                            <option value="En revisión">En revisión</option>
                            <option value="Aceptada">Aceptada</option>
                            <option value="Rechazada">Rechazada</option>
                            <option value="Finalista">Finalista</option>
                        </select>
                    </div>
                    <div class="filter-date">
                        <input type="date">
                    </div>
                    <button class="clear">Limpiar filtros</button>
                </div>

                <!-- TABLE -->
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>Participante</th>
                                <th>Sinopsis</th>
                                <th>Estado</th>
                                <th>Fecha presentación</th>
                                <th>Últ. actualización</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Filas cargadas dinámicamente desde JS -->
                        </tbody>
                    </table>

                    <div class="table-footer">
                        <div class="pagination-info">
                            Mostrando 0 de 0 candidaturas
                        </div>
                        <div class="pagination">
                            <button class="pagination-btn"><span>Anterior</span></button>
                            <button class="pagination-btn active">1</button>
                            <button class="pagination-btn">2</button>
                            <button class="pagination-btn">3</button>
                            <button class="pagination-btn"><span>Siguiente</span></button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- MODALES -->

    <!-- MODAL CAMBIAR ESTADO -->
    <div class="modal" id="changeModal">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <h2>Cambiar estado de candidatura</h2>
            <div class="modal-context">
                <p><strong>Participante:</strong> <span id="modal-participant"></span></p>
                <p><strong>Estado actual:</strong> <span id="modal-current-status"></span></p>
            </div>
            <label>
                Nuevo estado
                <select id="modalStatus">
                    <option value="En revisión">En revisión</option>
                    <option value="Aceptada">Aceptada</option>
                    <option value="Rechazada">Rechazada</option>
                    <option value="Finalista">Finalista</option>
                </select>
            </label>
            <label id="rejectReasonWrapper" style="display: none;">
                Motivo del rechazo *
                <textarea id="rejectReason" rows="3"
                    placeholder="Indique el motivo del rechazo (visible para el participante)"></textarea>
            </label>
            <div class="modal-actions">
                <button class="btn" id="closeModal">Cancelar</button>
                <button class="btn change" id="saveModal">Guardar</button>
            </div>
        </div>
    </div>

    <!-- MODAL DOCUMENTOS -->
    <div class="modal" id="documentsModal">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h2>Documentos de la candidatura</h2>
                <button class="close-btn" id="closeDocumentsModal">&times;</button>
            </div>
            <div class="tabs">
                <button class="tab-btn active" data-tab="video">Vídeo</button>
                <button class="tab-btn" data-tab="poster">Cartel</button>
                <button class="tab-btn" data-tab="technical">Ficha técnica</button>
            </div>
            <div class="tab-content">
                <div class="tab-pane active" id="video-pane">
                    <div class="video-container">
                        <img src="../img/Video_Cortometraje.png" alt="Video" class="video-placeholder">
                    </div>
                </div>
                <div class="tab-pane" id="poster-pane">
                    <div class="poster-container">
                        <img src="../img/Foto_corto.png" alt="Cartel" class="poster-placeholder">
                    </div>
                </div>
                <div class="tab-pane" id="technical-pane">
                    <div class="technical-info">
                        <img src="../img/Ficha_Tecnica.png" alt="Ficha técnica">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- MODAL DETALLE -->
<div class="modal" id="detailModal">
    <div class="modal-overlay"></div>
    <div class="modal-content">
        <div class="modal-header">
            <h2>Detalle de Candidatura</h2>
            <button class="close-btn" id="closeDetailModal">&times;</button>
        </div>
        <div class="detail-content">
            <div class="detail-row">
                <span><strong>ID Candidatura:</strong> <span id="detail-id"></span></span>
                <span><strong>Estado actual:</strong> <span id="detail-status" class="badge"></span></span>
            </div>
            <h3>Información del participante</h3>
            <div class="participant-info">
                <div class="info-item">
                    <img src="../img/icon/UserIcon.svg" alt="Nombre">
                    <span id="detail-name"></span>
                </div>
                <div class="info-item">
                    <img src="../img/icon/EmailIcon.svg" alt="Email">
                    <span id="detail-email"></span>
                </div>
                <div class="info-item">
                    <img src="../img/icon/IdIcon.svg" alt="ID">
                    <span id="detail-id-number"></span>
                </div>
                <div class="info-item">
                    <img src="../img/icon/HashIcon.svg" alt="Expediente">
                    <span id="detail-exp"></span>
                </div>
            </div>
            <h3>Información de la candidatura</h3>
            <div class="synopsis-detail">
                <strong>Sinopsis</strong>
                <p id="detail-synopsis"></p>
            </div>
            <div class="dates-row">
                <div class="date-item">
                    <img src="../img/icon/CalendarIcon.svg" alt="Fecha presentación">
                    <div>
                        <strong>Fecha de presentación</strong>
                        <div id="detail-date-presented"></div>
                    </div>
                </div>
                <div class="date-item">
                    <img src="../img/icon/CalendarIcon.svg" alt="Última actualización">
                    <div>
                        <strong>Última actualización</strong>
                        <div id="detail-date-updated"></div>
                    </div>
                </div>
            </div>
            <div class="reject-reason" id="detail-reject-reason" style="display: none; margin-top: 16px;">
                <strong>Motivo del rechazo:</strong>
                <p id="reject-reason-text"></p>
            </div>
        </div>
    </div>
</div>

    <!-- MODAL HISTORIAL -->
    <div class="modal" id="historyModal">
        <div class="modal-overlay"></div>
        <div class="modal-content history-modal">
            <div class="modal-header">
                <h2>Historial de estados</h2>
                <button class="close-btn" id="closeHistoryModal">&times;</button>
            </div>
            <div class="history-body">
                <div class="history-id">
                    <strong>ID Candidatura:</strong> <span id="history-id"></span>
                </div>
                <div class="timeline">
                    <!-- timeline cargado dinámicamente si quieres -->
                </div>
            </div>
        </div>
    </div>

    <!-- MODAL CONFIRMACIÓN -->
    <div class="modal" id="confirmationModal">
        <div class="modal-content">
            <p id="confirmationMessage"></p>
            <div class="modal-actions">
                <button class="btn" id="confirmNo">Cancelar</button>
                <button class="btn" id="confirmYes">Aceptar</button>
            </div>
        </div>
    </div>

    <!-- MODAL NOTIFICACIÓN -->
    <div class="modal" id="notificationModal">
        <div class="modal-content">
            <p id="notificationMessage"></p>
            <div class="modal-actions">
                <button class="btn" id="closeNotification">Aceptar</button>
            </div>
        </div>
    </div>

    <script src="../js/common.js"></script>
    <script src="../js/api-service.js"></script>
    <script src="../js/check-session.js"></script>
    <script src="../js/admin-candidaturas.js"></script>
    <script src="../js/menu-admin.js"></script>
</body>
</html>
